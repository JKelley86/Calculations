<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Secret Santa</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .hidden { display: none; }
        .form-group { margin-bottom: 10px; }
    </style>
</head>
<body>

    <h1>Secret Santa Setup</h1>

    <div id="setup">
        <h2>Enter Participants</h2>
        <div id="participants"></div>
        <button onclick="addParticipant()">Add Participant</button>
        <button onclick="assignSecretSanta()">Assign Secret Santa</button>
    </div>

    <div id="play" class="hidden">
        <h2>Check Assignment</h2>
        <p>Enter your name to see your assigned Secret Santa recipient:</p>
        <input type="text" id="playerName" placeholder="Enter your name">
        <button onclick="revealAssignment()">See Assignment</button>
        <p id="assignmentResult"></p>
    </div>

    <script>
        let participants = [];

        // Add participant and optional significant other
        function addParticipant() {
            const name = prompt("Enter participant's name:");
            if (!name) return;

            const partner = prompt(`Enter ${name}'s significant other (leave blank if none):`);
            participants.push({ name, partner, assigned: null });
            renderParticipants();
        }

        // Display participants and their partners
        function renderParticipants() {
            const list = document.getElementById('participants');
            list.innerHTML = participants.map(p => `<div>${p.name} ${p.partner ? `(Partner: ${p.partner})` : ''}</div>`).join('');
        }

        // Shuffle and assign Secret Santas
function assignSecretSanta() {
    // Clear previous assignments
    participants.forEach(p => p.assigned = null);
    
    // Create a shuffled list of participants to assign as recipients
    const recipients = [...participants].sort(() => Math.random() - 0.5);
    
    // Loop over each participant to assign them a Secret Santa
    for (let i = 0; i < participants.length; i++) {
        const santa = participants[i];

        // Find a recipient who is not the same person and is not their partner
        let possibleRecipients = recipients.filter(p => 
            p.name !== santa.name && 
            p.name !== santa.partner && 
            p.assigned === null
        );

        if (possibleRecipients.length === 0) {
            // If no valid recipient, re-run the function to try again
            alert("Unable to assign Secret Santa without conflicts. Trying again.");
            assignSecretSanta();
            return;
        }

        // Select a random recipient from the possible ones
        const recipient = possibleRecipients[Math.floor(Math.random() * possibleRecipients.length)];
        santa.assigned = recipient.name;

        // Mark the recipient as "assigned" by giving them a temporary property
        recipient.assigned = true;
    }

    alert("Secret Santa assignments complete!");
    document.getElementById("setup").classList.add("hidden");
    document.getElementById("play").classList.remove("hidden");
}
        // Reveal assignment based on player name entered
        function revealAssignment() {
            const playerName = document.getElementById("playerName").value.trim();
            const participant = participants.find(p => p.name.toLowerCase() === playerName.toLowerCase());

            if (participant && participant.assigned) {
                document.getElementById("assignmentResult").textContent = `Hello ${participant.name}, you are assigned to ${participant.assigned}.`;
            } else {
                document.getElementById("assignmentResult").textContent = "Name not found or no assignment available.";
            }
        }
    </script>

</body>
</html>
