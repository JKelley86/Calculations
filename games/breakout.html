function movePaddle(event) {
    const rect = canvas.getBoundingClientRect();
    let x = (event.clientX - rect.left) / (rect.right - rect.left) * canvasWidth;

    if (event.type === 'touchmove') {
        const touch = event.touches[0];
        x = (touch.clientX - rect.left) / (rect.right - rect.left) * canvasWidth;
    }

    if (x > paddleWidth / 2 && x < canvasWidth - paddleWidth / 2) {
        paddleX = x - paddleWidth / 2;
    }
}

function update() {
    if (gameOver || win) return;

    ballX += ballDX;
    ballY += ballDY;

    // Ball collision with walls
    if (ballX + ballDX > canvasWidth - ballRadius || ballX + ballDX < ballRadius) {
        ballDX = -ballDX;
    }
    if (ballY + ballDY < ballRadius) {
        ballDY = -ballDY;
    } else if (ballY + ballDY > canvasHeight - ballRadius) {
        if (ballX > paddleX && ballX < paddleX + paddleWidth) {
            ballDY = -ballDY;

            // Speed up the ball slightly after each paddle hit
            ballDX *= 1.05;
            ballDY *= 1.05;
        } else {
            lives--;
            if (!lives) {
                gameOver = true;
                drawGameOver();
            } else {
                ballX = canvasWidth / 2;
                ballY = canvasHeight - 30;
                ballDX = 2 * (Math.random() > 0.5 ? 1 : -1); // Randomize the ball's horizontal direction
                ballDY = -2;
                paddleX = (canvasWidth - paddleWidth) / 2;
            }
        }
    }

    detectCollision();
    if (win) {
        drawWinMessage();
    }
}
